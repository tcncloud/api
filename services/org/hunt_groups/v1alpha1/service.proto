syntax = "proto3";

package services.org.hunt_groups.v1alpha1;

import "annotations/authz.proto";
import "google/api/annotations.proto";
import "services/org/hunt_groups/v1alpha1/entities.proto";

// HuntGroupsService
service HuntGroupsService {
  rpc ListHuntGroupExileLinks(ListHuntGroupExileLinksRequest) returns (ListHuntGroupExileLinksResponse) {
    option (google.api.http).post = "/services/org/huntgroups/v1alpha1/listhuntgroupexilelinks";
    option (google.api.http).body = "*";
    option (annotations.authz) = {
      sets: [
        {
          permissions: [PERMISSION_HUNTGROUP_VIEW]
        }
      ]
    };
  }

  //
  // Agent Triggers
  //

  // ListHuntGroupAgentTriggers returns a list of agent triggers for the given hunt group.
  rpc ListHuntGroupAgentTriggers(ListHuntGroupAgentTriggersRequest) returns (ListHuntGroupAgentTriggersResponse) {
    option (google.api.http).post = "/services/org/huntgroups/v1alpha1/listhuntgroupagenttriggers";
    option (google.api.http).body = "*";
    option (annotations.authz) = {
      sets: [
        {
          permissions: [PERMISSION_HUNTGROUP_VIEW]
        }
      ]
    };
  }

  // CopyHuntGroupAgentTrigger copys an agent trigger to the given hunt group in the same org.
  rpc CopyHuntGroupAgentTrigger(CopyHuntGroupAgentTriggerRequest) returns (CopyHuntGroupAgentTriggerResponse) {
    option (google.api.http).post = "/services/org/huntgroups/v1alpha1/copyhuntgroupagenttrigger";
    option (google.api.http).body = "*";
    option (annotations.authz) = {
      sets: [
        {
          permissions: [PERMISSION_HUNTGROUP_EDIT]
        }
      ]
    };
  }

  // UpdateHuntGroupAgentTriggers updates all agent triggers for the given hunt group.
  rpc UpdateHuntGroupAgentTriggers(UpdateHuntGroupAgentTriggersRequest) returns (UpdateHuntGroupAgentTriggersResponse) {
    option (google.api.http).post = "/services/org/huntgroups/v1alpha1/updatehuntgroupagenttriggers";
    option (google.api.http).body = "*";
    option (annotations.authz) = {
      sets: [
        {
          permissions: [PERMISSION_HUNTGROUP_EDIT]
        }
      ]
    };
  }
}
